# Https基础

## HTTPS 概述

HTTPS（超文本传输安全协议）经由 HTTP 进行通讯，利用 SSL/TLS 加密数据包，提供身份认证、数据加密和完整性校验，防止信息窃听、篡改和劫持。

安全层的职责：对发出的 HTTP 请求数据加密，对收到的 HTTP 内容解密。

---

## TLS/SSL

TLS（安全传输层协议）及其前身 SSL（安全套接层）位于 TCP 和 HTTP 之间，不影响原有协议。

TLS/SSL 依赖三类算法：

- **散列函数（Hash）**：验证信息完整性
- **对称加密**：用协商的密钥加密数据
- **非对称加密**：实现身份认证和密钥协商

---

## 对称加密与非对称加密

### 对称加密

使用相同密钥进行加密和解密。

- 常见算法：AES、DES、3DES
- 优点：速度快，适合大量数据
- 缺点：密钥分发存在安全风险，密钥被截获则数据不安全

### 非对称加密

使用公钥加密、私钥解密（或私钥签名、公钥验证）。

- 常见算法：RSA、ECC、DSA
- 优点：公钥可公开分发，私钥只需持有者保管；支持数字签名
- 缺点：速度慢，适合少量数据

### 对比

| 特性 | 对称加密 | 非对称加密 |
| --- | --- | --- |
| 密钥数量 | 一个 | 一对（公钥 + 私钥） |
| 速度 | 快 | 慢 |
| 密钥分发 | 有风险 | 安全 |
| 适用场景 | 大量数据加密传输 | 密钥交换、数字签名 |

### 实际应用

TLS/SSL 结合两者：用非对称加密协商密钥，再用对称加密传输数据，兼顾安全性和效率。

---

## 数字证书

使用 Hash 算法对公钥和其他信息生成摘要，由 CA（证书颁发机构）用私钥对摘要签名，将原始信息与签名合并形成数字证书。

接收方验证流程：用相同 Hash 算法生成摘要 → 用 CA 公钥解密证书中的签名 → 对比两个摘要是否一致。

作用：防止中间人攻击。若无证书，中间人可替换公钥，截获并解密通信内容，双方无法察觉。

---

## HTTPS 握手过程

1. 客户端发送：协议版本号、随机数、支持的加密方法
2. 服务器返回：确认加密方法、服务器证书、服务器随机数
3. 客户端验证证书有效性，生成新随机数，用证书公钥加密后发送；同时发送前面所有内容的 Hash 供服务器校验
4. 服务器用私钥解密随机数，发送前面所有内容的 Hash 供客户端校验
5. 双方用三个随机数生成会话密钥，后续通信均使用该密钥对称加密

---

## HTTPS 优缺点

**优点**

- 身份认证，确保数据发送到正确的服务器
- 加密传输，防止数据被篡改或窃取
- 大幅增加中间人攻击成本

**缺点**

- 加解密过程消耗更多服务器资源
- 握手阶段耗时，增加页面加载时间
- SSL 证书需要付费，功能越强费用越高
- SSL 证书需绑定 IP，同一 IP 不能绑定多个域名
